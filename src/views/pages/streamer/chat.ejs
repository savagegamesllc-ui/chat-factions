<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title><%= title %></title>
    <link rel="stylesheet" href="/public/css/app.css" />
  </head>
  <body>
    <div class="container">

      <div class="header">
        <div class="brand">
          <div class="brand-dot"></div>
          <div>
            <%- include('../../partials/streamerHeader', {  pageTitle: 'chat',  pageSub: 'Commands, cooldowns, and vote rules',  activeTab: 'chat'}) %>
          </div>
        </div>
      </div>

      <div id="status" class="notice" style="display:none;"></div>

      <!-- NEW: Commands editor -->
      <div class="card">
        <div class="card-title">
          <h2>Chat Commands</h2>
          <div class="hint">Configure what your chat can trigger (and cooldowns).</div>
        </div>

        <div class="small muted" style="margin-top:8px; line-height:1.4;">
          Tip: if you already use Streamer.bot commands like <span class="mono">!vote</span>, you can avoid collisions by using aliases like
          <span class="mono">!cfhype</span>.
        </div>

        <div style="margin-top:12px;">
          <div id="commandsWrap" class="muted">Loading commands…</div>
        </div>
      </div>

      <div class="hr"></div>

      <!-- Legacy JSON editor (kept, not removed) -->
      <div class="card">
        <div class="card-title">
          <h2>Advanced (Legacy) Config JSON</h2>
          <div class="hint">Safe to ignore — kept for backwards compatibility</div>
        </div>

        <textarea id="cfg" rows="14" class="input" style="font-family: var(--mono);" placeholder="{ }"></textarea>

        <div style="margin-top: 12px; display:flex; gap:10px; flex-wrap:wrap;">
          <button class="btn" id="btnSave">Save JSON</button>
          <button class="btn" id="btnReset">Reset JSON to Defaults</button>
        </div>

        <details style="margin-top: 14px;">
          <summary class="small">Show Defaults</summary>
          <pre id="defaults" class="code"></pre>
        </details>
      </div>

      <script src="/public/js/streamer/chat.js"></script>
      <script>
        const s = document.getElementById('status');
        const mo = new MutationObserver(() => {
          const has = (s.textContent || '').trim().length > 0;
          s.style.display = has ? 'block' : 'none';
        });
        mo.observe(s, { childList: true, subtree: true, characterData: true });
      </script>
    </div>
  </body>
</html>
